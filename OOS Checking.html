<!DOCTYPE html>
<html>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<body>
<ng-container>
	<div ng-app="eBay" ng-controller="myCtrl">
		<b>Total items: {{totalItems}}</b>
		<br>
		<button ng-click="run()">Run</button>
		<div id="descList"></div>
	</div>
	</ng-container>
</body>

<script>
	var app = angular.module("eBay", []); 
	app.controller("myCtrl", function($scope, $http) {
		appId = 'PhinkNg-EbayChan-PRD-b08fef0ab-ae0ce710';
		token = 'v^1.1#i^1#f^0#p^3#I^3#r^0#t^H4sIAAAAAAAAAOVYf2wTVRxf90s3fhgCIkEk3SHESK5912uvdyctlP3ICmMr6wBh6nx392697XpX765sDRjGEhdFjCZIgkDMJEYiGhUVI0YSkahhBmUBBdQEEkNGgujgHxLQ4Ltu67oZhluJWWL/uObe+/74fD7f73v37kBHccmjXdVd16c57snv7gAd+Q4HNQWUFBctnl6QP7coD2QZOLo7Hu4o7Cy4tMSEcTXB1yMzoWsmcrbHVc3k04MBImlovA5NxeQ1GEcmb4l8NLSqhve4AJ8wdEsXdZVwhisCBERIQiwFOUb0+RHlxaPaUMwGPUAISIQyEBBD0QJFez143jSTKKyZFtSsAOEBFEcCD+lhG4CX9zE8oFx+mttAONciw1R0DZu4ABFMw+XTvkYW1rGhQtNEhoWDEMFwqCpaFwpXVNY2LHFnxQoO6hC1oJU0R96V6xJyroVqEo2dxkxb89GkKCLTJNzBgQwjg/KhITATgJ+WWvZCL8MJ0IdoPwOheFekrNKNOLTGxmGPKBIpp015pFmKlbqTolgNoQWJ1uBdLQ4RrnDaf6uTUFVkBRkBonJ5aP2aaGU94YxGIoa+UZGQZDOlAOenWIYCGG0ipmitustCYkzTVb05hWlSgwkHog7KPSpjua5Jii2e6azVreUIo0ejNfJmaYSN6rQ6IyRbNrJsOyajpW+DXdyBaiatmGbXF8WxIM707Z0rMdQaw81wt5pD8HCAZWmZkvySTwLD68xe6zk0SNCuUSgScdtYkABTZBwarchKqFBEpIjlTcaRoUg87ZM9NCsjUmI4mfRyskwKPokhKRkhgJAgiBz7f+wTyzIUIWmhTK+MnkiTDRC2trwCZd7SW5HWkEogYrRleisabJB2M0DELCvBu91tbW2uNtqlG81uDwCU+/FVNVExhuKQyNgqdzYmlXT3igh7mQpvYQABoh13Ik6uNRPB+sqq+spodVND3crK2qEuHoEsOHr0Nkyjop5AEV1VxNTkokgbUgQaViqKVBUP5ETStEn+1/TstT42RTuGiYPAhOKyO84l6nG3DvHuZQ81pVE7/42R28QiuQb2AhzZZSAo6ZqamojzOHwUbSNeQrqRmkjCjPM4fKAo6knNmki6QddxeMhJVVZU1d4lJpIwy308MDWopixFNDMpc2r8UCIRjseTFhRUFJYm1wL3eBkv68+Z3qRglX6uZ5hF7KdfbTNZiUtdHoMaGamvIAWAn8cygAIJERCRnwI5UV/VrEwK5sOs/ayf4SjODwDgcqJWgTZOjqpmc5Ohl+I8pJelAen14wuHEE3SXh/F0LIoelBu5SxXFbxRTL6DRrVuWkjKjRo+GU8uUvZyHFqNXlGiSI4ScGlFliWhJNOk3wfo21MuDI8kPcow62j5j7cL98jX/GBe+kd1Og6BTsfBfIcDuMFCagEoKy5YU1gwda6pWMiFj6EuU2nW8NurgVytKJWAipFf7Gic98HbTVkfFrqfBHMynxZKCqgpWd8ZwLzhmSLqvgemURzweFjg9TGA2gAWDM8WUrMLZ13su7JsMbt1Zk8Hf/7Gpq+m9HaX9INpGSOHoyivsNORd2ZZwxsvnKi41VI2v7/v9c4dB1r2L6q5MH3qjPn3n3jk2KdXb/5ad+PYuS+XXqiF+66dv1aa2rTooe0HG9s+62WN3etnBIt/7ynrhSviqdjm5fceP/TsXuPy9c3buwK7fC/Htrz72KWt5R9L/Td+Of/qpi9+2kX5+p4/Sv1RWvrcmaONV0rL3gms6Vu4b+tbT/986+yecyu7Djda3+1fq7bs/GTpn6cP17xmnrqg/bbivZn9haeZ3T98s6L3zd1tdete2fnURz5NOvLhth+vrjyx7n3Hlrlf7/j+7PUjz8zZ2951fA/zkhbu3PFg9Um3u7ynqfhwa9nqFlj9+bZvT7bfrDnW+kTRiweOnrr81+me2fLFWQPl+xvCGY448hEAAA==';
		$http.defaults.headers.common['X-EBAY-API-SITEID'] = '15';
		$http.defaults.headers.common['X-EBAY-API-REQUEST-ENCODING'] = 'XML';
		$http.defaults.headers.common['X-EBAY-API-COMPATIBILITY-LEVEL'] = '967';
		$http.defaults.headers.common['X-EBAY-API-IAF-TOKEN'] = token;
		
		parser = new DOMParser();
		$scope.totalItems = 0;
		$scope.result = [];
		
		$scope.run = function () {
			getItemRequest("323377626988");
		};
		
		getItemRequest = function (itemID) {
			$http.defaults.headers.common['X-EBAY-API-CALL-NAME'] = 'GetItem';
			url = 'https://api.ebay.com/ws/api.dll';
			data = getItemRequestBuilder(itemID);
			$http.post(url, data).then(function(res) {
				console.log(data);
				console.log(res); /*
				descList = document.getElementById("descList");
				xml = parser.parseFromString(res.data, "application/xml").childNodes[0];
				items = xml.getElementsByTagName("Item");
				$scope.totalItems += items.length;
				$scope.numberOfItems += items.length;	
				
				for (var i=0; i < items.length; i++) {
					item = items[i];
					desc = item.getElementsByTagName("Description")[0].childNodes[0].nodeValue;
					id = item.getElementsByTagName("ItemID")[0].childNodes[0].nodeValue;
					trimmedDesc = trimContactDetail(desc);
					
					/*
					descEle = document.createElement("p");
					idEle = document.createElement("h1");
					idEle.appendChild(document.createTextNode(item.getElementsByTagName("ItemID")[0].childNodes[0].nodeValue));
					descEle.innerHTML = trimmedDesc;
					descList.appendChild(idEle);
					descList.appendChild(descEle); */
			}, function (error) {
				console.log(error);
			});
		}
		
		
		getItemRequestBuilder = function (itemID) {
			request = "<?xml version='1.0' encoding='utf-8'?>" + "\n"
					+ "<GetItemRequest xmlns='urn:ebay:apis:eBLBaseComponents'>" + "\n"
					+ "<ErrorLanguage>en_US</ErrorLanguage>" + "\n"
					+ "   <IncludeItemSpecifics>True</IncludeItemSpecifics>" + "\n"
					+ "		<WarningLevel>High</WarningLevel>" + "\n"
					+ "	  <DetailLevel>ItemReturnDescription</DetailLevel>" + "\n"
					+ "	  <ItemID>" + itemID + "</ItemID>" + "\n"
					+ "	</GetSellerListRequest>";
			return request;
		}
	});
</script>

